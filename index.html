<!DOCTYPE html>
<html lang="ml">
<head>
  <meta charset="UTF-8">
  <title>üé≠ ‡¥°‡µç‡¥∞‡¥æ‡¥Æ ‡¥Æ‡¥æ‡¥®‡µá‡¥ú‡µç‚Äå‡¥Æ‡µÜ‡¥®‡µç‡¥±‡µç ‡¥¨‡µç‡¥Ø‡µÇ‡¥±‡µã</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+Malayalam:wght@400;600&display=swap" rel="stylesheet">

  <style>
    body {
      background: linear-gradient(135deg, #f7efe5, #f3e5d6);
      color: #2e2e2e;
      font-family: "Noto Sans Malayalam", sans-serif;
      padding: 20px;
    }
    .container-box { max-width: 700px; margin: auto; }
    .hero-card {
      background: #fff9f4; border-radius: 26px; padding: 30px;
      text-align: center; box-shadow: 0 8px 25px #00000010;
      margin-bottom: 30px;
    }
    .hero-title { font-size: 32px; font-weight: 700; color: #4d3a2e; line-height: 1.4; }
    .hero-sub { font-size: 15px; margin-top: 10px; color: #5e4f45; }
    .input-card {
      background: #fff9f4; padding: 26px; border-radius: 22px;
      box-shadow: 0 6px 20px #00000012;
    }
    .info-text { font-size: 12px; margin: -4px 0 8px 2px; color: #8c7c6f; }
    .form-control, .form-select {
      border-radius: 14px; padding: 12px; border: 1.6px solid #d7c3b0; background: #ffffff;
    }
    .btn-custom {
      background: #3a2f2f; color: white; border-radius: 16px;
      padding: 12px; margin-top: 12px; width: 100%; font-size: 17px;
      font-weight: 600; position: relative; overflow: hidden; transition: 0.3s ease;
    }
    .btn-custom.loading { color: transparent; }
    .loading-bar {
      position: absolute; top: 50%; left: 50%; width: 80%; height: 7px;
      border-radius: 10px; transform: translate(-50%, -50%);
      background: rgba(255, 255, 255, 0.2); overflow: hidden; opacity: 0; transition: 0.3s ease;
    }
    .loading-bar.active { opacity: 1; }
    .loading-fill {
      width: 25%; height: 100%; background: #00ffd5; border-radius: 10px;
      animation: slide 1.2s infinite linear;
    }
    @keyframes slide { 0% { transform: translateX(-120%); } 100% { transform: translateX(350%); } }
    .out-box {
      background: #fffbf7; padding: 24px; border-radius: 20px; margin-top: 20px;
      box-shadow: 0 6px 25px #00000018; white-space: pre-wrap;
      border-left: 5px solid #c7a88a; display: none; animation: fadeIn 0.9s ease;
    }
    @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
    .copy-btn {
      background: #4d3a2e; color: white; border-radius: 12px;
      padding: 8px 16px; font-size: 13px; float: right; margin-top: -8px;
      margin-bottom: 10px; transition: 0.3s;
    }
    #copiedAlert { display: none; text-align: right; color: #3c2f28; font-size: 13px; font-weight: 600; }
  </style>
</head>

<body>
<div class="container-box">

  <!-- HERO -->
  <div class="hero-card">
    <div class="hero-title">üé≠ ‡¥°‡µç‡¥∞‡¥æ‡¥Æ ‡¥Æ‡¥æ‡¥®‡µá‡¥ú‡µç‚Äå‡¥Æ‡µÜ‡¥®‡µç‡¥±‡µç ‡¥¨‡µç‡¥Ø‡µÇ‡¥±‡µã</div>
    <div class="hero-sub">
      Emotional Support? Athokke Pinne. Roast First‚Ñ¢ üò≠üî•<br>
      heartbreak, exam fear, overthinking, fake friends ‚Äî ‡¥é‡¥≤‡µç‡¥≤‡¥æ‡¥Ç roast + reset ‡¥ö‡µÜ‡¥Ø‡µç‡¥Ø‡µÅ‡¥Ç.
    </div>
  </div>

  <!-- INPUT CARD -->
  <div class="input-card">

    <label class="form-label">üë§ ‡¥™‡µá‡¥∞‡µÅ parayeda‚Ä¶ üòí</label>
    <input type="text" id="userName" class="form-control" placeholder="Your name">

    <br>
    <label class="form-label">üåÄ ‡¥é‡¥ô‡µç‡¥ô‡¥®‡µÜ ‡¥µ‡¥ø‡¥≥‡¥ø‡¥ï‡µç‡¥ï‡¥£‡¥Ç?</label>
    <select id="gender" class="form-select">
      <option value="female">Female (edi)</option>
      <option value="male">Male (eda)</option>
    </select>

    <br>
    <label class="form-label">üí≠ ‡¥é‡¥®‡µç‡¥§‡¥æ problem?</label>
    <textarea id="problem" class="form-control" rows="3" placeholder="Your problem..."></textarea>

    <button class="btn-custom" id="submitBtn" onclick="getCounselling()">
      üî• Therapy Tharatte
      <div class="loading-bar" id="loader">
        <div class="loading-fill"></div>
      </div>
    </button>

  </div>

  <!-- OUTPUT -->
  <div id="output" class="out-box">
    <button class="copy-btn" onclick="copyText()">Copy</button>
    <div id="copiedAlert">‚úî Copied!</div>
    <div id="responseText"></div>
  </div>

</div>


<script>
async function getCounselling() {
  const name = document.getElementById("userName").value.trim();
  const gender = document.getElementById("gender").value;
  const problem = document.getElementById("problem").value.trim();
  const btn = document.getElementById("submitBtn");
  const loader = document.getElementById("loader");

  if (!name || !problem) {
    alert("‡¥™‡µá‡¥∞‡µÅ‡¥Ç ‡¥™‡µç‡¥∞‡¥∂‡µç‡¥®‡¥µ‡µÅ‡¥Ç ‡¥é‡¥¥‡µÅ‡¥§‡¥£‡¥Ç! üòí");
    return;
  }

  btn.classList.add("loading");
  loader.classList.add("active");

  try {
    const res = await fetch("https://drama-management-bureau-1.onrender.com/api/roast", {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({ name, gender, problem })
    });

    const data = await res.json();
    document.getElementById("output").style.display = "block";
    document.getElementById("responseText").textContent = data.response;

  } catch (e) {
    document.getElementById("responseText").textContent = "‚ùå Server Error: " + e.message;
  }

  btn.classList.remove("loading");
  loader.classList.remove("active");
}

function copyText() {
  const text = document.getElementById("responseText").innerText;
  navigator.clipboard.writeText(text);

  const alert = document.getElementById("copiedAlert");
  alert.style.display = "block";
  setTimeout(() => alert.style.display = "none", 1200);
}
</script>

</body>
</html>
